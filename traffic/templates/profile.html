{%extends "base.html"%}
{%block content%}

<br>
<br>

<div class="container ">
	<h1 class="text-white" style="text-align:left;">PROFILE</h1>
	<div class="card" style="background-color:rgba(169,169,169, 0.3)" >
  		<div class="card-body" style="text-align:center;">
        <h5 class="card-title text-white">Civil ID:    {{request.user.profile.civil_id}}</h5>
        <br>
    		<h5 class="card-subtitle mb-2 text-white">Name:    {{request.user.first_name}} {{request.user.last_name}}</h5>
    		<br>
    		<h5 class="card-subtitle mb-2 text-white">Email:    {{request.user.email}}</h5>
    		<br>
        <h5 class="card-subtitle mb-2 text-white">Phone Number:    {{request.user.profile.phone_no}}</h5>
        <br>
    		<a href="{% url 'update-profile' %}" class="btn btn-outline-warning" >Edit Profile</a>    

    		<br>
    		<br>
    		<div class="container" style="text-align:left;">
  <table class="table table-borderless">
  <thead class="thead bg-danger text-white">
    <tr>
      <th scope="col">Accident ID</th>
      <th scope="col">Date & Time</th>
      <th scope="col">Location</th>
      <th scope="col">status</th>
      <th scope="col"></th>
    </tr>
  </thead class="thead text-white">
  <tbody class="thead text-white">
     <input id="latlng" type="text" value="40.714224,-73.961452">
    <input id="submit" type="button" value="Reverse Geocode">
  {% for accident in  accidents %}

  <tr>
    
  <td><a href="{% url 'accident-detail' accident.id %}">{{accident.id}}</a></td> 
  <td>{{accident.date_time}}</td>
  <td><div id="map"></div></td>
  <td>{{accident.status}}</td>
  <td><a href="{% url 'accident-detail' accident.id %}" class="btn btn-warning">view</a></td>
</tr>
  {% endfor %}
</tbody>
</table>
</div>  
<script>
      function initMap() {
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 8,
          center: {lat: 40.731, lng: -73.997}
        });
        var geocoder = new google.maps.Geocoder;
        var infowindow = new google.maps.InfoWindow;

        document.getElementById('submit').addEventListener('click', function() {
          geocodeLatLng(geocoder, map, infowindow);
        });
      }

      function geocodeLatLng(geocoder, map, infowindow) {
        var input = document.getElementById('latlng').value;
        var latlngStr = input.split(',', 2);
        var latlng = {lat: parseFloat(latlngStr[0]), lng: parseFloat(latlngStr[1])};
        geocoder.geocode({'location': latlng}, function(results, status) {
          if (status === 'OK') {
            if (results[0]) {
              map.setZoom(11);
              var marker = new google.maps.Marker({
                position: latlng,
                map: map
              });
              infowindow.setContent(results[0].formatted_address);
              infowindow.open(map, marker);
            } else {
              window.alert('No results found');
            }
          } else {
            window.alert('Geocoder failed due to: ' + status);
          }
        });
      }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDZG-gtTFCZ2SProv9zW0vM_97ZEVK9a1s&callback=initMap">
    </script>



{% endblock %}


