
{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block title %}Report an Accident{% endblock title %}

{% block content %}
<!--
<br>

<div class="container" style="    display: flex;
    justify-content: center;">
<div class="card text-center" style="width: 50rem;">
  <h3 class="card-header bg-white">Report an Accident</h3>
  <div class="card-body">

        <form action="{% url 'create-accident' involved %}" method="POST" enctype="multipart/form-data">
            <p>Please Provide Involved People Civil ID Numbers</p>
            <br>
            {% csrf_token %}
            {{involvedFormset.management_form}}
            {% for form in involvedFormset %}
                {{popForm|crispy}}
                {{form|crispy}}
            {% endfor %}
    <br>
    
            <h3>Location</h3>
            <div id="mapholder"></div>

            <button id="location" onclick="showLocation()" class="btn btn-outline-warning">Attach Location</button>
            <br>
        {{accidentForm|crispy}}
        <br>

        <h3>Car Registeration</h3>
        {{registrationFormset.management_form}}
        {% for form in registrationFormset %}
            {{form|crispy}}
        {% endfor %}

        <br>
       
    	<div>
    		<h3>Car accident images</h3>
        	{{car_images_form|crispy}}
    	</div>
          <br>
        <input type="submit" value="Report" class="btn btn-outline-warning">
    </form>

</div>
</div>
</div>-->

<div class="row">
<div class="col-2 col-lg-2 col-md-1 col-sm-2 "></div>
            <div class="col-8 col-lg-8 col-md-9 col-sm-7 form-block animated fadeInUp" style="margin-top:50px; background-color:rgba(105,105,105,0.5);">
                <h2 class="badge bg-danger">REPORT ACCIDENT</h2>
                          <div class="form">
                            <form action="{% url 'create-accident' involved%}" method="POST" style="color:black" enctype="multipart/form-data">
                              {% csrf_token %}
                              <div class="card pl-5" style="background-color:rgba(0,50,90.0,0.5); border-radius:20px;">
  <div class="card-header">
                                <h4 class="text-white">Please Provide Involved People Civil ID Numbers</h4>
                                </div>
                                <div class="card-body">
                                <div class="row">
                                {{involvedFormset.management_form}}
                                {% for form in involvedFormset %}
                                <div class="col form-group" >
                                  <span style="color:white;">Civil ID*</span>
                                    <p>{{form.civil_id}}</p>
                                    
                                </div>
                                <div class="col form-group" >
                                  <span style="color:white;">Email*</span>
                                    <p>{{form.email}}</p>
                                </div></div>
            {% endfor %}
        </div>
    </div>
    <br>
    <div class="card pl-5" style="background-color:rgba(0,50,90.0,0.5);border-radius:20px;">
  <div class="card-header">
            <h4 class="text-white">Car Rgistration Images</h4>
                                </div>
                                <div class="card-body">
            {{registrationFormset.management_form}}
        {% for form in registrationFormset %}
        <div class="row">
        <div class="col form-group" >
                                  <span style="color:white;">Car Registration*</span>
                                    <p  style="color: #cccccc;">{{form.regist_image}}</p>
                                </div>
                              </div>
        {% endfor %}
    </div>
</div>
<br>
<div class="card pl-5" style="background-color:rgba(0,50,90.0,0.5);border-radius:20px;">
  <div class="card-header">
        <h3 class="text-white ">Accident Detail</h3>
                                </div>
            
        <div class="card-body">
            <div class="form-group" >
                                <span style="color:white;">Attach your location*</span>
<br>
                                <div id="mapholder" ></div>

            <button id="location" onclick="showLocation()" class="btn btn-outline-warning">Click here to attach your Location</button>
            <br>
            {{accidentForm.location_longitude}}
{{accidentForm.location_latitude}}
                            </div>
        <div class="form-group" >

                                  <span style="color:white;">Accident Images*</span>
                                  <p class="text-white" style="font-size:13px">You can provide more than one image</p>
                                    <p style="color:#cccccc;">{{car_images_form.file_field}}</p>
                                </div>
                                <div  class="form-group" > 
                                <span style="color:white;">Your description*</span>      <p>{{accidentForm.description}}</p>
                            </div>
                            
                        </div>
                        
                              
        
</div>
   <br>                             
                                <input type="submit" value="Report" class="register">
                            </form>
                          </div>
                   <div class="col-2 col-lg-2 col-md-1 col-sm-1"></div>
                  
</div>
</div>


<script>

function showLocation() {
    if (navigator.geolocation.getCurrentPosition(showPosition)) {
        position=navigator.geolocation.getCurrentPosition(showPosition)
        showPosition(position)
    }
    else if(!navigator.geolocation){

        document.getElementById("mapholder").innerHTML =  "<p>Geolocation is not supported by this browser.</p>";
    }
}
function showPosition(position) {

       
        var latlon = position.coords.latitude + "," + position.coords.longitude;
        var img_url = "https://maps.googleapis.com/maps/api/staticmap?center="+latlon+"&zoom=18&size=400x300&sensor=false&key=AIzaSyDZG-gtTFCZ2SProv9zW0vM_97ZEVK9a1s";

document.getElementById("id_location_longitude").value=position.coords.longitude.toFixed(6)
document.getElementById("id_location_latitude").value=position.coords.latitude.toFixed(6)
document.getElementById("mapholder").innerHTML = "<img src='"+img_url+"'>";
   
}

</script>



	{% endblock %}


